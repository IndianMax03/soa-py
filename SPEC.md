# Сервис-ориентированная архитектура

> v.31415

Разработать спецификацию в формате OpenAPI для набора веб-сервисов, реализующего следующую функциональность:

## Первый веб-сервис

Должен осуществлять управление коллекцией объектов. В коллекции необходимо хранить объекты класса `Flat`, описание которого приведено ниже:

```java
public class Flat {
    private int id; //Значение поля должно быть больше 0, Значение этого поля должно быть уникальным, Значение этого поля должно генерироваться автоматически
    private String name; //Поле не может быть null, Строка не может быть пустой
    private Coordinates coordinates; //Поле не может быть null
    private java.util.Date creationDate; //Поле не может быть null, Значение этого поля должно генерироваться автоматически
    private Integer area; //Максимальное значение поля: 858, Значение поля должно быть больше 0
    private int numberOfRooms; //Значение поля должно быть больше 0
    private long price; //Значение поля должно быть больше 0
    private boolean furniture;
    private View view; //Поле не может быть null
    private House house; //Поле не может быть null
}
public class Coordinates {
    private double x;
    private double y; //Значение поля должно быть больше -513
}
public class House {
    private String name; //Поле не может быть null
    private Integer year; //Максимальное значение поля: 964, Значение поля должно быть больше 0
    private Integer numberOfLifts; //Значение поля должно быть больше 0
}
public enum View {
    STREET,
    YARD,
    PARK,
    NORMAL,
    TERRIBLE;
}
```

Веб-сервис должен удовлетворять следующим требованиям:

- API, реализуемый сервисом, должен соответствовать рекомендациям подхода RESTful.
- Необходимо реализовать следующий базовый набор операций с объектами коллекции: добавление нового элемента, получение элемента по ИД, обновление элемента, удаление элемента, получение массива элементов.
- Операция, выполняемая над объектом коллекции, должна определяться методом HTTP-запроса.
- Операция получения массива элементов должна поддерживать возможность сортировки и фильтрации по любой комбинации полей класса, а также возможность постраничного вывода результатов выборки с указанием размера и порядкового номера выводимой страницы.
- Все параметры, необходимые для выполнения операции, должны передаваться в URL запроса.
- Информация об объектах коллекции должна передаваться в формате json.
- В случае передачи сервису данных, нарушающих заданные на уровне класса ограничения целостности, сервис должен возвращать код ответа http, соответствующий произошедшей ошибке.

Помимо базового набора, веб-сервис должен поддерживать следующие операции над объектами коллекции:

- Сгруппировать объекты по значению поля coordinates, вернуть количество элементов в каждой группе.
- Вернуть количество объектов, значение поля numberOfRooms которых равно заданному.
- Вернуть количество объектов, значение поля furniture которых больше заданного.

Эти операции должны размещаться на отдельных URL.

## Второй веб-сервис

Должен располагаться на URL `/agency`, и реализовывать ряд дополнительных операций, связанных с вызовом API первого сервиса:

- `/get-most-expensive/{id1}/{id2}/{id3}` : выбрать из трёх квартир с заданными id наиболее дорогую
- `/get-total-cost` : рассчитать суммарную стоимость всех квартир, имеющихся в базе

Эти операции также должны размещаться на отдельных URL.

Для разработанной спецификации необходимо сгенерировать интерактивную веб-документацию с помощью `Swagger UI`. Документация должна содержать описание всех REST API обоих сервисов с текстовым описанием функциональности каждой операции. Созданную веб-документацию необходимо развернуть на сервере.

## Вопросы для изучения

- Подходы к проектированию приложений. "Монолитная" и сервис-ориентированная архитектура.
- Понятие сервиса. Общие свойства сервисов.
- Основные принципы SOA. Подходы к реализации SOA, стандарты и протоколы.
- Общие принципы построения и элементы сервис-ориентированных систем.
- Понятие веб-сервиса. Определение, особенности, отличия от веб-приложений.
- Категоризация веб-сервисов. RESTful и SOAP. Сходства и отличия, области применения.
- RESTful веб-сервисы. Особенности подхода. Понятия ресурса, URI и полезной нагрузки (payload).
- Виды RESTful-сервисов. Интерпретация методов HTTP в RESTful.
- Правила именования ресурсов в RESTful сервисах.
- Спецификация RESTful-сервисов. Стандарт OpenAPI.
- Автодокументирование RESTful-сервисов. Swagger Editor, Swagger UI (и Swagger Codegen).
- Архитектурный принцип HATEOAS.
